// Code generated by goa v3.19.1, DO NOT EDIT.
//
// interceptorsServer Interceptors
//
// Command:
// $ goa gen goa.design/examples/interceptors/design

package interceptors

import (
	"context"

	goa "goa.design/goa/v3/pkg"
)

// ServerInterceptors defines the interface for all server-side interceptors.
// Server interceptors execute after the request is decoded and before the
// payload is sent to the service. The implementation is responsible for calling
// next to complete the request.
type ServerInterceptors interface {
	// Server-side interceptor which implements a transparent cache for loaded
	// records
	Cache(ctx context.Context, info *CacheInfo, next goa.Endpoint) (any, error)
	// Server-side interceptor that validates JWT token and tenant ID
	JWTAuth(ctx context.Context, info *JWTAuthInfo, next goa.Endpoint) (any, error)
	// Server-side interceptor that provides comprehensive request/response audit
	// logging
	RequestAudit(ctx context.Context, info *RequestAuditInfo, next goa.Endpoint) (any, error)
	// Server-side interceptor which sets the context deadline for the request
	SetDeadline(ctx context.Context, info *SetDeadlineInfo, next goa.Endpoint) (any, error)
	// Server-side interceptor that adds trace context to the request payload
	TraceRequest(ctx context.Context, info *TraceRequestInfo, next goa.Endpoint) (any, error)
}

// Access interfaces for interceptor payloads and results
type (
	// CacheInfo provides metadata about the current interception.
	// It includes service name, method name, and access to the endpoint.
	CacheInfo goa.InterceptorInfo

	// CachePayload provides type-safe access to the method payload.
	// It allows reading and writing specific fields of the payload as defined
	// in the design.
	CachePayload interface {
		RecordID() UUID
	}

	// CacheResult provides type-safe access to the method result.
	// It allows reading and writing specific fields of the result as defined
	// in the design.
	CacheResult interface {
		SetCachedAt(string)
	}
	// JWTAuthInfo provides metadata about the current interception.
	// It includes service name, method name, and access to the endpoint.
	JWTAuthInfo goa.InterceptorInfo

	// JWTAuthPayload provides type-safe access to the method payload.
	// It allows reading and writing specific fields of the payload as defined
	// in the design.
	JWTAuthPayload interface {
		Auth() string
		TenantID() UUID
	}
	// RequestAuditInfo provides metadata about the current interception.
	// It includes service name, method name, and access to the endpoint.
	RequestAuditInfo goa.InterceptorInfo

	// RequestAuditResult provides type-safe access to the method result.
	// It allows reading and writing specific fields of the result as defined
	// in the design.
	RequestAuditResult interface {
		Status() int
		SetProcessedAt(string)
		SetDuration(int)
	}
	// SetDeadlineInfo provides metadata about the current interception.
	// It includes service name, method name, and access to the endpoint.
	SetDeadlineInfo goa.InterceptorInfo
	// TraceRequestInfo provides metadata about the current interception.
	// It includes service name, method name, and access to the endpoint.
	TraceRequestInfo goa.InterceptorInfo

	// TraceRequestPayload provides type-safe access to the method payload.
	// It allows reading and writing specific fields of the payload as defined
	// in the design.
	TraceRequestPayload interface {
		SetTraceID(UUID)
		SetSpanID(UUID)
	}
)

// Private implementation types
type (
	cacheGetPayload struct {
		payload *GetPayload
	}
	jWTAuthGetPayload struct {
		payload *GetPayload
	}
	jWTAuthCreatePayload struct {
		payload *CreatePayload
	}
	traceRequestGetPayload struct {
		payload *GetPayload
	}
	traceRequestCreatePayload struct {
		payload *CreatePayload
	}
	cacheGetResult struct {
		result *GetResult
	}
	requestAuditGetResult struct {
		result *GetResult
	}
	requestAuditCreateResult struct {
		result *CreateResult
	}
)

// WrapGetEndpoint wraps the get endpoint with the server-side interceptors
// defined in the design.
func WrapGetEndpoint(endpoint goa.Endpoint, i ServerInterceptors) goa.Endpoint {
	endpoint = wrapGetCache(endpoint, i)
	endpoint = wrapGetJWTAuth(endpoint, i)
	endpoint = wrapGetRequestAudit(endpoint, i)
	endpoint = wrapGetSetDeadline(endpoint, i)
	endpoint = wrapGetTraceRequest(endpoint, i)
	return endpoint
}

// WrapCreateEndpoint wraps the create endpoint with the server-side
// interceptors defined in the design.
func WrapCreateEndpoint(endpoint goa.Endpoint, i ServerInterceptors) goa.Endpoint {
	endpoint = wrapCreateJWTAuth(endpoint, i)
	endpoint = wrapCreateRequestAudit(endpoint, i)
	endpoint = wrapCreateSetDeadline(endpoint, i)
	endpoint = wrapCreateTraceRequest(endpoint, i)
	return endpoint
}

// Public accessor methods for Info types

// Payload returns a type-safe accessor for the method payload.
func (info *CacheInfo) Payload() CachePayload {
	return &cacheGetPayload{payload: info.RawPayload.(*GetPayload)}
}

// Result returns a type-safe accessor for the method result.
func (info *CacheInfo) Result(res any) CacheResult {
	return &cacheGetResult{result: res.(*GetResult)}
}

// Payload returns a type-safe accessor for the method payload.
func (info *JWTAuthInfo) Payload() JWTAuthPayload {
	switch info.Method {
	case "Get":
		return &jWTAuthGetPayload{payload: info.RawPayload.(*GetPayload)}
	case "Create":
		return &jWTAuthCreatePayload{payload: info.RawPayload.(*CreatePayload)}
	default:
		return nil
	}
}

// Result returns a type-safe accessor for the method result.
func (info *RequestAuditInfo) Result(res any) RequestAuditResult {
	switch info.Method {
	case "Get":
		return &requestAuditGetResult{result: res.(*GetResult)}
	case "Create":
		return &requestAuditCreateResult{result: res.(*CreateResult)}
	default:
		return nil
	}
}

// Payload returns a type-safe accessor for the method payload.
func (info *TraceRequestInfo) Payload() TraceRequestPayload {
	switch info.Method {
	case "Get":
		return &traceRequestGetPayload{payload: info.RawPayload.(*GetPayload)}
	case "Create":
		return &traceRequestCreatePayload{payload: info.RawPayload.(*CreatePayload)}
	default:
		return nil
	}
}

// Private implementation methods

func (p *cacheGetPayload) RecordID() UUID {
	return p.payload.RecordID
}
func (r *cacheGetResult) SetCachedAt(v string) {
	r.result.CachedAt = &v
}

func (p *jWTAuthGetPayload) Auth() string {
	return p.payload.Auth
}
func (p *jWTAuthGetPayload) TenantID() UUID {
	return p.payload.TenantID
}
func (p *jWTAuthCreatePayload) Auth() string {
	return p.payload.Auth
}
func (p *jWTAuthCreatePayload) TenantID() UUID {
	return p.payload.TenantID
}

func (r *requestAuditGetResult) Status() int {
	return r.result.Status
}
func (r *requestAuditGetResult) SetProcessedAt(v string) {
	r.result.ProcessedAt = v
}
func (r *requestAuditGetResult) SetDuration(v int) {
	r.result.Duration = v
}
func (r *requestAuditCreateResult) Status() int {
	return r.result.Status
}
func (r *requestAuditCreateResult) SetProcessedAt(v string) {
	r.result.ProcessedAt = v
}
func (r *requestAuditCreateResult) SetDuration(v int) {
	r.result.Duration = v
}

func (p *traceRequestGetPayload) SetTraceID(v UUID) {
	p.payload.TraceID = &v
}
func (p *traceRequestGetPayload) SetSpanID(v UUID) {
	p.payload.SpanID = &v
}
func (p *traceRequestCreatePayload) SetTraceID(v UUID) {
	p.payload.TraceID = &v
}
func (p *traceRequestCreatePayload) SetSpanID(v UUID) {
	p.payload.SpanID = &v
}
